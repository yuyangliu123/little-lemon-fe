import{aw as v,ay as T,aJ as N,at as Q,ax as u,j as e,B as r,V as M,w as z,aB as A,s as _,aK as q,T as F,H as O,t as Y,r as h,an as D,q as U,Z as H,p as L,I as $,$ as P}from"./index-DK1BDKGD.js";import{n as C}from"./navConfig-BpbbTEl9.js";import{D as V}from"./chunk-W7WUSNWJ-rLaptAsQ.js";import{B}from"./chunk-UVUR7MCU-Dbi6v9Kw.js";import"./index-DVxGg5Dc.js";var W=["refetch","reobserve","fetchMore","updateQuery","startPolling","subscribeToMore"];function J(a,n){var o,s=v.useRef(),t=v.useRef(),c=v.useRef(),d=T(n,s.current||{}),S=(o=d?.query)!==null&&o!==void 0?o:a;t.current=n,c.current=S;var m=N(Q(n&&n.client),S),j=m.useQuery(u(u({},d),{skip:!s.current})),x=j.observable.options.initialFetchPolicy||m.getDefaultFetchPolicy(),f=Object.assign(j,{called:!!s.current}),b=v.useMemo(function(){for(var l={},g=function(w){var I=f[w];l[w]=function(){return s.current||(s.current=Object.create(null),m.forceUpdateState()),I.apply(this,arguments)}},i=0,p=W;i<p.length;i++){var R=p[i];g(R)}return l},[]);Object.assign(f,b);var y=v.useCallback(function(l){s.current=l?u(u({},l),{fetchPolicy:l.fetchPolicy||x}):{fetchPolicy:x};var g=T(t.current,u({query:c.current},s.current)),i=m.executeQuery(u(u({},g),{skip:!1})).then(function(p){return Object.assign(p,b)});return i.catch(function(){}),i},[]);return[y,f]}const K=({cart:a,showMiniCart:n,setShowMiniCart:o,ref:s})=>e.jsx(r,{display:n?"block":"none",position:{[C.showNavSize]:"absolute",base:"fixed"},right:{[C.showNavSize]:"0",base:"0"},bottom:{[C.showNavSize]:"auto",base:"0"},minWidth:{[C.showNavSize]:"400px",base:"100%"},backgroundColor:"#fff",border:"1px solid #ccc",onClick:()=>o(!n),ref:s,children:e.jsxs(M,{children:[e.jsx(r,{alignSelf:"start",margin:"1rem 0 0 1rem",textStyle:"StyledNav",children:a?e.jsxs(e.Fragment,{children:["Your Cart (",a.totalItem," items)"]}):e.jsx(e.Fragment,{children:"Your Cart (0) items"})}),e.jsx(B,{onClick:()=>o(!n),backgroundColor:"#ffffff",position:"absolute",top:"10px",right:"25px",children:e.jsx(z,{})}),e.jsx(r,{width:"100%",maxHeight:"400px",overflowX:"hidden",overflowY:"scroll",children:!a||a.totalItem===0?e.jsx(r,{margin:"0 0 0 1rem",children:"No Item in Cart"}):Object.values(a.data).map(t=>e.jsx(r,{display:"block",width:"100%",_hover:{backgroundColor:"#e9e9e9"},children:e.jsx(A,{to:`/order2/${t.strMeal}/${t.idMeal}`,state:{strMeal:t.strMeal,strMealThumb:t.strMealThumb,id:t.idMeal},children:e.jsxs(M,{width:"100%",children:[e.jsxs(_,{width:"100%",children:[e.jsx(r,{width:"30%",children:e.jsx(r,{width:"8rem",children:e.jsx(q,{src:t.strMealThumb,alt:t.strMeal,width:"80%",imgWidth:"100",auto:"webp",height:"100px",margin:"auto"})})}),e.jsxs(M,{align:"start",width:"70%",children:[e.jsx(r,{textStyle:"StyledText",color:"#333333",width:"100%",children:e.jsx(F,{overflow:"hidden",textOverflow:"ellipsis",children:t.strMeal})}),e.jsxs(r,{textStyle:"StyledText",color:"#333333",children:[t.numMeal," x $",t.baseAmount]})]})]}),e.jsx(V,{size:"lg",borderWidth:"1px",borderColor:"#e5e5e5"})]})})},t.idMeal))}),e.jsxs(r,{width:"100%",display:"flex",justifyContent:"space-around",paddingBottom:"1vh",children:[e.jsx(O,{to:"/cart",children:e.jsx(B,{sx:Y.textStyles.StyledButton.baseStyle,size:"md",children:"View Cart"})}),e.jsx(r,{alignSelf:"end",marginRight:"1rem",textStyle:"StyledNav",children:a?e.jsxs(e.Fragment,{children:["Total Price ($",a.totalAmount,")"]}):e.jsx(e.Fragment,{children:"Total Price ($0)"})})]})]})}),X=P`
query Cartitemnumber($identifier: String!, $isEmail: Boolean) {
  cartitemnumber(identifier: $identifier,isEmail:$isEmail) {
    totalItem
  }
}
`,Z=P`
query Shoppingcarts($identifier: String!, $isEmail: Boolean) {
    shoppingcarts(identifier: $identifier,isEmail:$isEmail) {
      totalItem
      totalAmount
      data {
        idMeal
        strMealThumb
        strMeal
        numMeal
        baseAmount
      }
    }
  }
`,se=({showcart:a=!0,...n})=>{const{cartItem:o,setCartItem:s,cartItemChangedRef:t}=h.useContext(D),{identifier:c,isEmail:d,accessToken:S}=U(),{data:m,loading:j,error:x}=H(X,{variables:{identifier:c,isEmail:d},fetchPolicy:"cache-and-network",skip:!c,onCompleted:k=>{s(k.cartitemnumber[0].totalItem)},onError:k=>{console.log(k)}}),[f,b]=h.useState(!1),[y,l]=h.useState(!1),[g,{data:i,loading:p,error:R}]=J(Z,{fetchPolicy:"cache-and-network",skip:!c||!o||o<=0||!a}),[w,I]=h.useState(null),E=h.useRef();return L([E],()=>{l(!1)}),j?e.jsx(r,{children:e.jsx($,{src:"/images/Basket.svg"})}):x?(console.error("CART_ITEM_QUERY error",x),e.jsx("p",{children:"Error!"})):e.jsxs(r,{position:"relative",onClick:()=>{l(!y),t.current&&(g({variables:{identifier:c,isEmail:d}}),t.current=!1),b(!0)},ref:E,...n,children:[e.jsx(r,{position:"absolute",display:"inline-flex",right:"-0.5rem",top:"0.3rem",zIndex:"100",backgroundColor:"red",color:"white",borderRadius:"50%",height:"22px",width:"22px",alignItems:"center",justifyContent:"center",children:o}),e.jsx(r,{children:e.jsx($,{src:"/images/Basket.svg"})}),f&&e.jsx(h.Suspense,{children:e.jsx(K,{cart:i&&i.shoppingcarts&&i.shoppingcarts.length>0?i.shoppingcarts[0]:null,showMiniCart:y,setShowMiniCart:l})})]},"Cart")};export{se as default};

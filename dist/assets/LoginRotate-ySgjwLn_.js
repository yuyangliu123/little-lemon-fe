import{f as y,a3 as z,j as e,aF as M,b as W,r as h,z as G,ae as $,a9 as J,aa as b,ad as U,ah as V,S as C,B as d,af as T,aj as R,ag as _,q as F,aG as X,al as Y,aH as A,J as D}from"./index-CSaA1nFA.js";import{u as K,a as L}from"./ModalsSystem-uwFOgr8A.js";import O from"./Signup-Cli2zUhA.js";import Q from"./ForgotPassword-1eQZaqRk.js";import{u as Z,H as ee}from"./chunk-7OLJDQMT-B2iVonpa.js";import{B as N}from"./chunk-UVUR7MCU-jy_K_3Vu.js";import"./chunk-CWVAJCXJ-Bu8JRnmM.js";var te=W("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),f=y(function(n,r){var a,o;const{placement:i="left",...x}=n,m=M(),t=m.field,g={[i==="left"?"insetStart":"insetEnd"]:"0",width:(a=t?.height)!=null?a:t?.h,height:(o=t?.height)!=null?o:t?.h,fontSize:t?.fontSize,...m.element};return e.jsx(te,{ref:r,__css:g,...x})});f.id="InputElement";f.displayName="InputElement";var B=y(function(n,r){const{className:a,...o}=n,i=z("chakra-input__left-element",a);return e.jsx(f,{ref:r,placement:"left",className:i,...o})});B.id="InputLeftElement";B.displayName="InputLeftElement";var E=y(function(n,r){const{className:a,...o}=n,i=z("chakra-input__right-element",a);return e.jsx(f,{ref:r,placement:"right",className:i,...o})});E.id="InputRightElement";E.displayName="InputRightElement";const de=({onLoginSuccess:u})=>{const[n,r]=h.useState(!1),[a,o]=h.useState(""),{updateToken:i}=G(),{closeModal:x}=K(),m=$(),t=J().shape({email:b().required("Please enter your email"),password:b().required("Please enter your password")}),{register:j,handleSubmit:g,watch:H,formState:{errors:v,isValid:se}}=U({mode:"onSubmit",resolver:V(t)}),I=H("email"),P=()=>r(!n),S=Z(),k=h.useRef();h.useEffect(()=>{const w=setTimeout(()=>{const l=[k],s=[I];l.forEach((c,p)=>{c.current&&c.current.value!==s[p]&&(c.current.value=s[p])})},100);return()=>clearTimeout(w)},[I]);const q=async w=>{try{const l={...w},s=await Y.post("http://ec2-107-23-219-13.compute-1.amazonaws.com/login/login",l,{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(s.status===200){const c=s.data;localStorage.setItem("accessToken",c.accessToken);const p=A();D.set("X-CSRF-Token",p,{secure:!0,sameSite:"strict"}),S({title:"Login Success",description:"You will soon be redirected",status:"success",duration:2e3});const ne=await i();x(),u&&u({token:c.accessToken})}else s.status===400&&(o(s.statusText),S({title:"Login Failed",description:"Something Went Wrong",status:"error",duration:2e3}))}catch(l){const s=l.response?.data?.message||"Login Failed";o(s),S({title:"Login Failed",description:s,status:"error",duration:2e3}),console.log("Error:",l)}};return e.jsxs(e.Fragment,{children:[e.jsxs(C,{direction:"column",marginBottom:"2",justifyContent:"center",alignItems:"center",children:[e.jsx(ee,{color:"teal.400",children:"Welcome"}),e.jsx(d,{minW:{base:"90%",md:"468px"},children:e.jsx("form",{onSubmit:g(q),children:e.jsxs(C,{spacing:4,p:"1rem",backgroundColor:"white",boxShadow:"md",children:[e.jsx(T,{children:e.jsx(R,{children:e.jsx(_,{type:"email",placeholder:"email address",ref:k,...j("email")})})}),e.jsxs(T,{children:[e.jsxs(R,{children:[e.jsx(_,{type:n?"text":"password",placeholder:"Password",...j("password")}),e.jsx(E,{width:"4.5rem",children:e.jsx(N,{h:"1.75rem",size:"sm",onClick:P,children:n?"Hide":"Show"})})]}),e.jsxs(F,{width:"100%",justifyContent:"space-between",textStyle:"StyledText",fontSize:"1rem",color:"#000000",children:[e.jsxs(d,{children:[v.password&&e.jsx("p",{children:v.password.message}),a&&e.jsx("p",{children:a}),m&&e.jsx("p",{children:"Caps Lock is active!"})]}),e.jsx(d,{justifyContent:"end",children:e.jsx(X,{children:e.jsx(L,{nest:!0,targetContent:e.jsx(Q,{}),children:"forgot password?"})})})]})]}),e.jsx(N,{borderRadius:0,type:"submit",variant:"solid",colorScheme:"teal",width:"full",children:"Login"})]})})})]}),e.jsx(d,{children:e.jsxs(F,{width:"fit-content",margin:"auto",children:[e.jsxs(d,{children:["New to us?"," "]}),e.jsx(L,{color:"teal.500",nest:!0,targetContent:e.jsx(O,{}),children:"Signup"})]})})]})};export{de as default};

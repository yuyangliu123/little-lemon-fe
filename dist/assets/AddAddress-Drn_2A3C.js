import{aX as _,y as J,r,M as O,K as Q,a9 as Y,a_ as Z,aa as u,X as I,ad as A,ah as ee,j as e,S as p,B as se,af as i,aj as l,V as h,ag as m,q as E,G as te}from"./index-CSaA1nFA.js";import{u as ae}from"./ModalsSystem-uwFOgr8A.js";import{u as re,H as de}from"./chunk-7OLJDQMT-B2iVonpa.js";import{C as ne}from"./chunk-CWVAJCXJ-Bu8JRnmM.js";import{B as $}from"./chunk-UVUR7MCU-jy_K_3Vu.js";const pe=({operateAddress:s,addressInfo:a,allAddress:y})=>{_();const g=re(),{fname:M,lname:T,email:P}=J(),{closeModal:w}=ae(),{setAllAddressInfo:G}=r.useContext(O),{setModalState:ce}=r.useContext(Q),H=Y().shape({addressFname:u().required("first name is required"),addressLname:u().required("last name is required"),phone:u().required("Phone number is required").matches(/^[0-9]+$/,"Phone number must contain only digits").min(8,"Phone number must be at least 8 digits").max(15,"Phone number cannot exceed 15 digits"),address1:u().required("address is required"),address2:u(),city:u().required("city is required"),country:u().required("country is required"),asDefault:Z()}),{setValue:N}=I(),{register:n,handleSubmit:W,control:ie,watch:d,trigger:X,formState:{errors:t,isValid:oe}}=A({resolver:ee(H),defaultValues:{addressFname:s==="update"?a.addressFname:M,addressLname:s==="update"?a.addressLname:T,phone:s==="update"?a.phone:"",address1:s==="update"?a.address1:"",address2:s==="update"?a.address2:"",city:s==="update"?a.city:"",country:s==="update"?a.country:"",asDefault:s==="create"&&y.length===0?!0:s==="update"?a.isDefault:!1},mode:"onBlur"}),b=d("addressFname"),C=d("addressLname"),R=d("phone"),F=d("address1"),z=d("address2"),q=d("city"),S=d("country");d("payment"),d("asDefault");const L=r.useRef(),k=r.useRef(),v=r.useRef(),j=r.useRef(),K=r.useRef(),B=r.useRef(),D=r.useRef();r.useEffect(()=>{const f=setTimeout(()=>{const V=[L,k,v,j,K,B,D],o=[b,C,R,F,z,q,S];V.forEach((c,x)=>{c.current&&c.current.value!==o[x]&&(c.current.value=o[x])})},100);return()=>clearTimeout(f)},[b,C,R,F,q,S]);const U=async f=>{if(await X(["phone","address1","city","country"]))try{const o={...f,email:P,state:s==="create"?"create":s==="update"?"update":"",uuid:a?.uuid||void 0},c=await te.post("http://ec2-107-23-219-13.compute-1.amazonaws.com/checkout/checkoutInfo",o);c.status===200&&g({title:`Address ${s==="create"?"added":s==="update"?"updated":""} successfully`,status:"success",duration:2e3}),G(x=>({...x,shippingInfo:c.data.shippingInfo,addressInfo:c.data.updatedAddress})),N("selectedAddress",c.data.updatedAddress?.uuid),w()}catch(o){console.error("Error:",o),g({title:"Error occurred",description:o.message,status:"error",duration:2e3})}};return e.jsx(e.Fragment,{children:e.jsxs(p,{direction:"column",marginBottom:"2",justifyContent:"center",alignItems:"center",children:[e.jsx(de,{color:"teal.400",children:"Welcome"}),e.jsx(se,{minW:{base:"70%",md:"468px"},children:e.jsx("form",{onSubmit:W(U),style:{width:"100%"},children:e.jsxs(p,{id:"addAddress",spacing:4,p:"1rem",backgroundColor:"white",boxShadow:"md",width:"100%",children:[e.jsxs(p,{direction:{base:"column",md:"row"},children:[e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"addressFname",placeholder:"First Name",width:"100%",ref:L,...n("addressFname")}),t.addressFname&&e.jsx("p",{children:t.addressFname.message})]})})}),e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"addressLname",placeholder:"Last Name",width:"100%",ref:k,...n("addressLname")}),t.addressLname&&e.jsx("p",{children:t.addressLname.message})]})})})]}),e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"number",name:"phone",placeholder:"Contact number*",width:"100%",ref:v,...n("phone")}),t.phone&&e.jsx("p",{children:t.phone.message})]})})}),e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"address1",placeholder:"Address line 1*",width:"100%",ref:j,...n("address1")}),t.address1&&e.jsx("p",{children:t.address1.message})]})})}),e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"address1",placeholder:"Address line 2",width:"100%",ref:j,...n("address2")}),t.address2&&e.jsx("p",{children:t.address2.message})]})})}),e.jsxs(p,{direction:{base:"column",md:"row"},children:[e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"city",placeholder:"Town/City",width:"100%",ref:B,...n("city")}),t.city&&e.jsx("p",{children:t.city.message})]})})}),e.jsx(i,{children:e.jsx(l,{children:e.jsxs(h,{width:"100%",children:[e.jsx(m,{type:"text",name:"country",placeholder:"County/State",width:"100%",ref:D,...n("country")}),t.country&&e.jsx("p",{children:t.country.message})]})})})]}),e.jsxs(E,{marginTop:"1rem",justifyContent:"space-between",children:[e.jsx(i,{children:e.jsx(ne,{id:"default-address",...n("asDefault"),disabled:s==="update"&&a.isDefault||s==="create"&&y.length===0,children:"Set As Default"})}),e.jsxs(E,{children:[e.jsx($,{onClick:()=>{w()},children:"Cancel"}),e.jsx($,{type:"submit",children:"Save"})]})]})]})})})]})})};export{pe as default};
